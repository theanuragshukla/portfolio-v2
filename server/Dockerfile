FROM alpine

RUN apk add nodejs npm bash curl

ARG CLIENT_URL
ARG MONGO_URL
ARG JWT_SECRET
ARG ADMIN_SECRET

ENV MONGO_URL $MONGO_URL
ENV JWT_SECRET $JWT_SECRET
ENV ADMIN_SECRET $ADMIN_SECRET
ENV CLIENT_URL $CLIENT_URL

WORKDIR /app

COPY package*.json .

COPY . .

RUN npm ci

EXPOSE 8000

CMD [ "node" , "index.js" ]
